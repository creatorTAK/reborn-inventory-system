# ドキュメント管理ルール

**作成日**: 2025年10月19日
**目的**: どの情報をどのドキュメントに保存するか、明確な判断基準を定める

---

## 📚 3つのドキュメントの役割

### 1. **CLAUDE.md** - プロジェクト完全リファレンス ★メイン

**対象**: Claude Code（AI開発アシスタント）
**目的**: プロジェクト全体を理解し、次の開発を進めるための完全リファレンス

**保存すべき内容**:
- ✅ 新機能の実装内容（機能概要、完成度、実装ファイル、関数名、行番号）
- ✅ **このプロジェクト固有のトラブルと解決策**
- ✅ データ構造の変更（新しい列追加、設定マスタ変更等）
- ✅ 開発ルールの追加・変更
- ✅ 完成度の更新
- ✅ 次の実装予定の更新

**保存しないもの**:
- ❌ 汎用的な技術トラブル（PWA構成を再現する際に誰でも遭遇する問題）
- ❌ サービス・ツールの基本情報

---

### 2. **PWA_SETUP_GUIDE.md** - 技術構成の再現マニュアル

**対象**: 他のプロジェクトで同じPWA + GAS構成を再現したい開発者
**目的**: ゼロから同じ構成を作るための完全マニュアル

**保存すべき内容**:
- ✅ **PWA + GAS + postMessage 構成に関するトラブル**
- ✅ **Firebase/FCM関連のトラブル**
- ✅ **Cloudflare Pages/GitHub Pages関連のトラブル**
- ✅ **汎用的な技術的問題**（他のプロジェクトでも遭遇する可能性が高い）
- ✅ セットアップ手順の追加・修正
- ✅ テンプレートコードの更新

**保存しないもの**:
- ❌ REBORNプロジェクト固有の機能（商品登録、設定管理等）
- ❌ ビジネスロジックの問題

**判断基準**:
- 「他のPWA + GASプロジェクトを作る時にも役立つか？」
- YES → PWA_SETUP_GUIDE.md に保存
- NO → CLAUDE.md のみに保存

---

### 3. **DEVELOPMENT_SERVICES.md** - 開発環境・ツール一覧

**対象**: チームメンバー、将来の自分
**目的**: 使用しているサービス・ツールの一覧と操作方法

**保存すべき内容**:
- ✅ 新しいサービス・ツールの追加（例: 新しいMCPツール導入）
- ✅ 既存サービスの設定変更（例: Gemini APIキーの変更）
- ✅ 料金の変更
- ✅ アカウント情報の更新
- ✅ 操作ガイドの追加（例: 新しいショートカットキー）

**保存しないもの**:
- ❌ コードのトラブルシューティング
- ❌ 機能実装の詳細

---

## 🎯 セッション終了時のテンプレート

セッション終了時に、以下のように伝えてください：

### パターン1: すべて任せる（推奨）

```
「今回のセッション内容をドキュメントに保存してください」
```

→ Claude Code が自動的に以下を判断します：
1. 実装した機能 → CLAUDE.md（機能セクション）
2. 遭遇したトラブル → CLAUDE.md（過去のトラブルと教訓） + PWA_SETUP_GUIDE.md（該当する場合）
3. 新しいツールの導入 → DEVELOPMENT_SERVICES.md
4. 最終更新日 → 該当する全ドキュメント

### パターン2: 具体的に指定

```
「〇〇の問題をドキュメントに保存してください」
```

例:
- 「複数デバイス通知の問題をドキュメントに保存してください」
- 「デフォルトセールスワード機能をドキュメントに保存してください」

---

## 📝 保存時の判断フロー（Claude Code用）

```
┌─────────────────────────────────────┐
│ セッション内容を分析                 │
└─────────────────────────────────────┘
              ↓
┌─────────────────────────────────────┐
│ 新機能の実装？                       │
│ YES → CLAUDE.md（機能セクション）    │
└─────────────────────────────────────┘
              ↓
┌─────────────────────────────────────┐
│ トラブルシューティング？             │
│ YES → 次の判断へ                     │
└─────────────────────────────────────┘
              ↓
┌─────────────────────────────────────┐
│ PWA + GAS構成に関する問題？          │
│ YES → CLAUDE.md + PWA_SETUP_GUIDE.md │
│ NO  → CLAUDE.md のみ                 │
└─────────────────────────────────────┘
              ↓
┌─────────────────────────────────────┐
│ 新しいツール・サービス導入？         │
│ YES → DEVELOPMENT_SERVICES.md        │
└─────────────────────────────────────┘
              ↓
┌─────────────────────────────────────┐
│ 最終更新日を更新                     │
│ （全該当ドキュメント）               │
└─────────────────────────────────────┘
```

---

## 📊 今回のセッション（2025/10/19）の実例

### 実装した内容
1. ✅ デフォルトセールスワード設定（新機能）
2. ✅ 商品属性削除バグ修正
3. ✅ アプリ音が鳴らない問題の修正
4. ✅ iPhone SEスクロール問題の修正
5. ✅ 複数デバイス通知問題の修正

### 保存先の判断結果

| 内容 | CLAUDE.md | PWA_SETUP_GUIDE.md | DEVELOPMENT_SERVICES.md |
|------|-----------|-------------------|------------------------|
| デフォルトセールスワード設定（機能） | ✅ 機能セクション | ❌ | ❌ |
| 問題⑫: iPhone SEスクロール | ✅ トラブル | ✅ 問題11 | ❌ |
| 問題⑬: 商品属性削除 | ✅ トラブル | ❌（REBORN固有） | ❌ |
| 問題⑭: アプリ音停止 | ✅ トラブル | ✅ Firebase初期化 | ❌ |
| 問題⑮: 複数デバイス通知 | ✅ トラブル | ✅ 問題10 | ❌ |
| 最終更新日 | ✅ | ✅ | ✅ |

---

## ✅ このルールのメリット

1. **迷わない**: どこに保存するか毎回判断しなくて良い
2. **漏れない**: Claude Code が自動的に全該当箇所を更新
3. **探しやすい**: 目的別に整理されているので、後から見つけやすい
4. **再現可能**: PWA構成を他のプロジェクトで再現する際に、PWA_SETUP_GUIDE.mdだけ見れば良い

---

## 🔄 今後の運用

このルールは、開発が進むにつれて随時アップデートしていきます。

**更新履歴**:
- 2025年10月19日: 初版作成
